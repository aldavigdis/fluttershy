<header>

	<nav class="row">
		<ul class="breadcrumb pull-right">
			<li><%= link_to "Home", "/" %> <span class="divider">/</span></li>
			<li><%= link_to "Companies", :controller => "companies", :action => "index" %> <span class="divider">/</span></li>
			<li><%= link_to @company.name, @company %> <span class="divider">/</span></li>
			<li><%= link_to "Users", :action => "index" %></li>
		</ul>
	</nav>

	<div class="row">
	
		<div class="users-list span9 offset3">
		
			<h1>Users assigned to <%= @company.name %></h1>
		
		</div>
	
	</div>

</header>

<div class="row">
	
	<% if ((session[:user_access] == 2)&&(session[:company_id] == @company.id)) || session[:user_access] == 4 %>
	<div class="top-buttons span9 offset3">
		<%= link_to "New User", new_company_user_path(), html_options = { class: "btn" } %>
	</div>
	<% end %>
	
	<div class="span9 pull-right">
		
		<% if @company.users.size == 0 %>
		<div class="alert">
			<span>No users are assigned to this company. Self-service will not work.</span>
		</div>
		<% else %>
		<table class="table table-responsive table-striped table-hover" id="table-company-users">
			<thead>
				<tr>
					<th span="col" class="fullname">Full name</th>
					<th span="col" class="email">Email</th>
					<% if ((session[:user_access] == 2)&&(session[:company_id] == @company.id)) || session[:user_access] == 4 %>
					<th span="col" class="access">Access</th>
					<% end %>
					<% if ((session[:user_access] == 2)&&(session[:company_id] == @company.id)) || session[:user_access] == 3 || session[:user_access] == 4 %>
					<th span="col" class="status">
						Status
					</th>
					<% end %>
				</tr>
			</thead>
			<tbody>
				<% @company.users.each do |user| %>
				<tr>
					<th span="row">
						<% if ((session[:user_access] == 2)&&(session[:company_id] == @company.id)) || session[:user_access] == 4 %>
						<%= link_to user.fullname, company_user_path(@company, user) %>
						<% else %>
						<%= user.fullname %>
						<% end %>
					</th>
					<td class="email"><%= mail_to user.email %></td>
 					<td class="access"><%= @user_access_levels.invert[user.access] %></td>
					<% if ((session[:user_access] == 2)&&(session[:company_id] == @company.id)) || session[:user_access] == 3 || session[:user_access] == 4 %>
					<td>
						<% if user.enabled %>
						<span class="label label-success">Enabled</span>
						<% else %>
						<span class="label label-important">Disabled</span>
						<% end %>
					</td>
					<% end %>
				</tr>
				<% end %>
			</tbody>
		</table>
		<% end %>
						
	</div>
	
	<%= render "shared/company_sidebar" %>
	
</div>
